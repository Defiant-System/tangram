let Anim={init(t){},dispatch(t){let i=Anim,s;switch(t.type){case"start":i.cvs=t.canvas;i.ctx=i.cvs.getContext("2d");i.width=i.cvs.width;i.height=i.cvs.height;i.dispatch({type:"create-scene"});i.paused=false;i.draw();break;case"pause":i.paused=true;break;case"resume":if(i.paused&&i.ctx){i.paused=false;i.draw()}break;case"create-scene":i.tick=0;i.size=40;i.lines=[];i.cvs.width=i.cvs.width;i.cvs.height=i.cvs.height;let s=i.size;break}},update(t){let i=t.lines.length;while(i--){t.lines[i].step(i)}if(t.tick%10===0){t.lines.push(new Line)}t.tick++},draw(){let t=Anim,i=t.cvs,s=t.ctx,e=t.width/2,h=t.height/2,a=t.lines.length;s.globalCompositeOperation="destination-out";s.fillStyle="hsla(0, 0%, 0%, 0.1)";s.fillRect(0,0,t.width,t.height);s.globalCompositeOperation="screen";s.save();s.translate(e,h);s.rotate(t.tick*1e-4);var n=.8+Math.cos(t.tick*.005)*.1;s.scale(n,n);s.translate(-e,-h);while(a--){t.lines[a].draw(s)}s.restore();if(!t.paused){t.update(t);requestAnimationFrame(t.draw)}}};Anim.init();self.onmessage=t=>Anim.dispatch(t.data);let Utils={rand(t,i){return Math.random()*(i-t)+t},randInt(t,i){return Math.floor(t+Math.random()*(i-t+1))},calculateDistance(t,i,s,e){let h=t-s,a=i-e;return Math.sqrt(h**2+a**2)}};class Line{constructor(){this.path=[];this.speed=Utils.rand(10,20);this.count=Utils.randInt(10,30);this.size=Anim.size;this.lines=Anim.lines;this.x=Anim.width/2,+1;this.y=Anim.height/2+1;this.target={x:Anim.width/2,y:Anim.height/2};this.dist=0;this.angle=0;this.hue=Anim.tick/5;this.life=1;this.updateAngle();this.updateDist()}updateDist(){var t=this.target.x-this.x,i=this.target.y-this.y;this.dist=Math.sqrt(t*t+i*i)}updateAngle(){var t=this.target.x-this.x,i=this.target.y-this.y;this.angle=Math.atan2(i,t)}changeTarget(){var t=Utils.randInt(0,3);switch(t){case 0:this.target.y=this.y-this.size;break;case 1:this.target.x=this.x+this.size;break;case 2:this.target.y=this.y+this.size;break;case 3:this.target.x=this.x-this.size;break}this.updateAngle()}step(t){this.x+=Math.cos(this.angle)*this.speed;this.y+=Math.sin(this.angle)*this.speed;this.updateDist();if(this.dist<this.speed){this.x=this.target.x;this.y=this.target.y;this.changeTarget()}this.path.push({x:this.x,y:this.y});if(this.path.length>this.count){this.path.shift()}this.life-=.001;if(this.life<=0){this.path=null;this.lines.splice(t,1)}}draw(t){t.beginPath();var i=Utils.rand(0,10);for(let s=0,e=this.path.length;s<e;s++){t[s===0?"moveTo":"lineTo"](this.path[s].x+Utils.rand(-i,i),this.path[s].y+Utils.rand(-i,i))}t.strokeStyle=`hsla(280, 50%, 65%, ${this.life/5})`;t.lineWidth=Utils.rand(.1,2);t.stroke()}}